{% extends "layout.html" %}
{% block title %}Home{% endblock %}

{% block content %}
<div class="container">

  <!-- Hero Section -->
  <div class="p-5 mb-4 bg-light rounded-3 shadow-sm">
    <div class="container-fluid py-5 text-center">
      <h1 class="display-5 fw-bold">🔄 Serial to QR Converter</h1>
      <p class="lead">Convert serials into QR codes or decode DataMatrix images back to text.</p>
    </div>
  </div>

  <!-- Upload Guidelines -->
  <div class="card mb-4 shadow-sm">
    <div class="card-header bg-primary text-white">
      <h5 class="mb-0">📋 Upload Guidelines</h5>
    </div>
    <div class="card-body">
      <ul class="mb-0">
        <li>Upload a valid <strong>.txt</strong> file with one serial per line</li>
        <li>Or paste serials directly into the form</li>
        <li>Only plain text — no images or binary content</li>
      </ul>
    </div>
  </div>

  <!-- QR Generation Form -->
  <div class="card mb-4 shadow-sm">
    <div class="card-header bg-success text-white">
      <h5 class="mb-0">📦 Generate QR Codes</h5>
    </div>
    <div class="card-body">
      <form method="POST" action="{{ url_for('main.upload_and_export') }}" enctype="multipart/form-data">
        <div class="mb-3">
          <label for="qrFile" class="form-label">Upload a text file</label>
          <input type="file" class="form-control" id="qrFile" name="file" accept=".txt" aria-label="Upload text file">
        </div>

        <div class="mb-3">
          <label for="serials" class="form-label">Or paste serials below</label>
          <textarea name="serials" id="serials" class="form-control" rows="6" placeholder="One serial per line..." aria-label="Paste serials"></textarea>
        </div>

        <div class="mb-3">
          <label for="size" class="form-label">QR Code Size</label>
          <select name="size" id="size" class="form-select" aria-label="Select QR code size">
            <option value="small">Small</option>
            <option value="medium" selected>Medium</option>
            <option value="large">Large</option>
          </select>
        </div>

        <button type="submit" class="btn btn-success w-100">🚀 Generate QR</button>
      </form>
    </div>
  </div>

  <!-- Image Upload Guidelines -->
  <div class="card mb-4 shadow-sm">
    <div class="card-header bg-warning text-dark">
      <h5 class="mb-0">🖼️ Image Upload Guidelines</h5>
    </div>
    <div class="card-body">
      <ul class="mb-0">
        <li>Upload a valid <strong>image</strong> file containing a DataMatrix code</li>
        <li>Supported formats: <strong>.png, .jpg, .jpeg, .bmp</strong></li>
        <li>No plain text or binary files</li>
      </ul>
    </div>
  </div>

  <!-- DataMatrix Decoding Form -->
  <div class="card shadow-sm">
    <div class="card-header bg-info text-white">
      <h5 class="mb-0">🔍 Decode DataMatrix</h5>
    </div>
    <div class="card-body">
      <form method="POST" action="{{ url_for('main.decode_datamatrix') }}" enctype="multipart/form-data">
        <div class="mb-3">
          <label for="dmFile" class="form-label">Upload an image file</label>
          <input type="file" class="form-control" id="dmFile" name="file" accept=".png,.jpg,.jpeg,.bmp" aria-label="Upload image file">
        </div>
        <button type="submit" class="btn btn-info w-100">🧠 Decode to Text</button>
      </form>
    </div>
  </div>

  <!-- Optional: Decoded Output -->
  {% if decoded_text %}
    <div class="alert alert-success mt-4" role="alert">
     <div class="d-flex justify-content-between align-items-center mb-2">
      <h5 class="alert-heading mb-0">✅ Decoded Text</h5>
       <button class="btn btn-sm btn-outline-secondary" onclick="copyDecodedText()">
        📋 Copy
       </button>
     </div>
      <pre id="decodedText" class="mb-0">{{ decoded_text }}</pre>
    </div>
  {% elif error %}
    <div class="alert alert-danger mt-4" role="alert">
  	<strong>Error:</strong> {{ error }}
    </div>
  {% endif %}

 </div>
{% endblock %}

