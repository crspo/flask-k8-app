
{% extends "layout.html" %}
{% block content %}
<div class="container py-5">
  <div class="row">
    <div class="col-md-8 mx-auto">
      <p class="lead">
        Welcome to <strong>Text To Datamatrix Converter</strong> â€” a streamlined solution designed to simplify QR code generation and PDF creation with precision and flexibility.
      </p>
      <h1 class="mb-4"> DM code preview: </h1>
      		<img id="qrImage" src="data:image/png;base64,{{ img_base64 }}" alt="QR Code" />
		<br/>
		<button onclick="printQRCode()">Print QR Code</button>
		<br/>
      <script>
	function printQRCode() {
    		const img = document.getElementById('qrImage');
    		const qrSrc = img ? img.src : '';

    		const w = window.open('', '', 'height=600,width=800');
    		w.document.write(`
       	 	<html>
       		 <head><title>Print QR Code</title></head>
        	<body style="text-align:center; margin-top:40px;">
            	<img src="${qrSrc}" id="printQR" style="max-width:100%; height:auto;" />
        	</body>
        	</html>
    		`);

    	// Wait for image to load, then trigger print
    		w.document.close();
    		w.onload = () => {
        	const printedImg = w.document.getElementById('printQR');
        	if (printedImg.complete) {
            		w.focus();
            		w.print();
        	    	w.close();
              } else {
            	printedImg.onload = () => {
                	w.focus();
                	w.print();
                	w.close();
        	    };
       	 	}
    	    };
	 }
      </script>
    </div>
  </div>
</div>
{% endblock %}
